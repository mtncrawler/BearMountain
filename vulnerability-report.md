## Vulnerability Report
### insecure direct object references
	// Insecure direct object references would look like this
   public ActionResult Edit(int id)
       {
           var user = _context.Users.FirstOrDefault(e => e.Id == id);
           return View("Details", new UserViewModel(user);
       }
	- We can identify this issue by analyzing ids to ensure that they match what intend them to match to.
	We can fix this issue by using the following code:
	// Secure
   public ActionResult Edit(int id)
       {
           var user = _context.Users.FirstOrDefault(e => e.Id == id);
           // Establish user has right to edit the details
           if (user.Id != _userIdentity.GetUserId())
           {
               HandleErrorInfo error = new HandleErrorInfo(new Exception("INFO: You do not have permission to edit these details"));
               return View("Error", error);
           }
           return View("Edit", new UserViewModel(user);
       }
	- Essentially, we are checking the user ID twice. 
	- This is not an issue with dotnet Core as these issues would exist in any programming language.

### using components with known vulnerabilities
	- This vulnerability would possibly happen by using older versions of dotnet or by forgoing several patches and updates for dotnet core.  We will fix any possible vulnerabilities by ensuring that we are using the latest dotnet framework with all of the latest patches. We could also use the OWASP dependency checker to find any high level vulnerabilities.  

### SQL Injection
SQL Injection is an attack where malicious code is inserted by user input that queries the backend database to access data that is not intended. This can lead to access to user lists, sensitive data, table deletion, or admin rights priviledges.  
	- A SQL injection vulnerability would lead to access to payment information, user PPI, and order information from our site.
	- Our site counters this vulnerability by using Entity Framework to query our databases. The code below utilizes Entity Framework and SQL injection is avoided by not using any user inputted information to query.   
	    
		public async Task<IViewComponentResult> InvokeAsync(string email)
        {
            var id = _context.UserBasket.FirstOrDefault(e => e.UserID == email).ID;

            var basketItemsInCart =  await _context.BasketItems.Where(cart => cart.UserBasketID == id).ToListAsync();

            return View(basketItemsInCart);
        }

### Sensitive Data Exposure
  Sensitive data exposure occurrs when protect payment information or personally identifiable information is not protected properly and is exposed to malicious access.  
	- Sensitive data must be protected to prevent misuse of personal information that may be used for malicious purposes such as identity theft or fraud.  
	- Our site combats sensitive data exposure by using ASP.NET Core Identity Framework which utilizes data protection through easy to use cryptographic API.  

	@if (SignInManager.IsSignedIn(User))
	{
    @await Component.InvokeAsync("ItemsInCart", @SignInManager.UserManager.GetUserName(User))
	}  

